<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="robots" content="noindex" />
    <title>Painel Admin - Clínica FISIO</title>
    
    <!-- Netlify CMS Styles -->
    <style>
        /* Custom styles para o CMS */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        /* Customização do header do CMS */
        .nc-app-header {
            background: linear-gradient(135deg, #1a365d 0%, #2b77ad 50%, #4da6d9 100%) !important;
        }
        
        /* Customização dos botões */
        .nc-button-primary {
            background: #4da6d9 !important;
            border-color: #4da6d9 !important;
        }
        
        .nc-button-primary:hover {
            background: #2b77ad !important;
            border-color: #2b77ad !important;
        }
        
        /* Loading customizado */
        .loading-screen {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            background: linear-gradient(135deg, #1a365d 0%, #2b77ad 50%, #4da6d9 100%);
            color: white;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        .loading-logo {
            font-size: 3rem;
            font-weight: bold;
            margin-bottom: 1rem;
        }
        
        .loading-text {
            font-size: 1.2rem;
            margin-bottom: 2rem;
        }
        
        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top: 4px solid white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Ocultar o loading quando o CMS carregar */
        .cms-loaded .loading-screen {
            display: none;
        }
    </style>
</head>
<body>
    <!-- Tela de Loading -->
    <div class="loading-screen" id="loading">
        <div class="loading-logo">FISIO</div>
        <div class="loading-text">Carregando Painel Administrativo</div>
        <div class="spinner"></div>
    </div>


    <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
    <script>
    if (window.netlifyIdentity) {
        window.netlifyIdentity.on("init", user => {
        if (!user) {
            window.netlifyIdentity.on("login", () => {
            document.location.href = "/admin/";
            });
        }
        });
    }
    </script>

    <!-- Netlify CMS -->
    <script src="https://unpkg.com/netlify-cms@^2.0.0/dist/netlify-cms.js"></script>
    
    <!-- Configuração customizada -->
    <script>
        // Aguardar o CMS carregar
        window.addEventListener('load', function() {
            setTimeout(() => {
                document.body.classList.add('cms-loaded');
            }, 2000);
        });

        // Configurações customizadas do CMS
        CMS.registerPreviewStyle('/style/global.css');
        CMS.registerPreviewStyle('/style/blog.css');
        
        // Preview template customizado para posts
        const PostPreview = createClass({
            render: function() {
                const entry = this.props.entry;
                const image = entry.getIn(['data', 'imagem']);
                const title = entry.getIn(['data', 'titulo']);
                const summary = entry.getIn(['data', 'resumo']);
                const category = entry.getIn(['data', 'categoria']);
                const date = entry.getIn(['data', 'data']);
                
                return h('div', {className: 'post-card'},
                    h('div', {className: 'post-image'},
                        image ? h('img', {src: image, alt: title}) : 
                        h('div', {className: 'post-image-placeholder'}, 
                            h('i', {className: 'fas fa-image'})
                        )
                    ),
                    h('div', {className: 'post-content'},
                        h('span', {className: `post-category ${category}`}, category),
                        h('h3', {className: 'post-title'}, title),
                        h('p', {className: 'post-summary'}, summary),
                        h('div', {className: 'post-date'}, 
                            h('i', {className: 'fas fa-calendar'}),
                            new Date(date).toLocaleDateString('pt-BR')
                        )
                    )
                );
            }
        });
        
        CMS.registerPreviewTemplate('posts', PostPreview);
        
        // Widget customizado para upload de imagem
        CMS.registerWidget('image', 'image', {
            pattern: /\.(gif|jpg|jpeg|tiff|png|webp)$/i,
            fromBlock: match => match && {
                image: match[2]
            },
            toBlock: data => `![${data.alt || ''}](${data.image})`,
            toPreview: data => `<img src="${data.image}" alt="${data.alt || ''}" />`
        });

        console.log('✅ Netlify CMS carregado para Clínica FISIO');
    </script>
</body>
</html>